(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{4870:function(e,t,n){Promise.resolve().then(n.t.bind(n,7960,23)),Promise.resolve().then(n.bind(n,6110)),Promise.resolve().then(n.bind(n,8121))},6110:function(e,t,n){"use strict";n.d(t,{FabMenu:function(){return i}});var o=n(7437),a=n(7648),s=n(9376),r=n(2265),l=n(1127);function i(){let e=["/menu","/settings"].includes((0,s.usePathname)()),t=(0,l.g)(e=>e.profile.theme);return((0,r.useEffect)(()=>{"undefined"!=typeof document&&document.documentElement.setAttribute("data-theme",t||"default")},[t]),e)?null:(0,o.jsx)("div",{className:"fixed bottom-5 right-5 z-50",children:(0,o.jsx)(a.default,{href:"/menu",className:"rounded-full w-14 h-14 grid place-items-center bg-brand text-white shadow-soft active:scale-95 select-none text-2xl",children:"â˜°"})})}},8121:function(e,t,n){"use strict";n.d(t,{ThemeEffect:function(){return s}});var o=n(2265),a=n(1127);function s(){let e=(0,a.g)(e=>e.profile.theme),t=(0,a.g)(e=>e.profile.language||"en");return(0,o.useEffect)(()=>{"undefined"!=typeof document&&document.documentElement.setAttribute("data-theme",e||"default")},[e]),(0,o.useEffect)(()=>{if("undefined"!=typeof document){document.documentElement.setAttribute("lang",t);let e="he"===t?"rtl":"ltr";document.documentElement.setAttribute("dir",e)}},[t]),null}},1127:function(e,t,n){"use strict";n.d(t,{O:function(){return u},g:function(){return f}});var o=n(9625),a=n(6885);let s=e=>Math.floor(Math.random()*e),r=(e,t,n)=>Math.max(t,Math.min(n,e)),l=(e,t,n)=>"mul"===e?"m:".concat(t,"x").concat(n):"d:".concat(t,"/").concat(n);function i(){return Math.floor(Date.now()/1e3)}let u=[{id:"star",label:"Shiny Star",emoji:"\uD83C\uDF1F",cost:50},{id:"rocket",label:"Rocket",emoji:"\uD83D\uDE80",cost:120},{id:"rainbow",label:"Rainbow",emoji:"\uD83C\uDF08",cost:250},{id:"unicorn",label:"Unicorn",emoji:"\uD83E\uDD84",cost:400}],c={profile:{points:0,streak:0,bestStreak:0,level:1,maxFactor:2,totalCorrect:0,totalAttempts:0,soundOn:!0,unlocked:{},language:"en",theme:"default"},mastery:{},recentMistakes:[],lastOp:void 0,sessionStartAt:void 0,sessionAttempts:0,sessionCorrect:0};function m(e){let t=s(e)+1,n=s(e)+1;return{op:"mul",a:t,b:n,answer:t*n}}function d(e){let t=s(e)+1,n=s(e)+1;return{op:"div",a:t*n,b:t,answer:n}}let f=(0,o.Ue)()((0,a.tJ)((e,t)=>({...c,startSession:()=>e(e=>e.sessionStartAt?e:{sessionStartAt:Date.now(),sessionAttempts:0,sessionCorrect:0}),endSession:()=>e(e=>e.sessionStartAt?{lastSession:{durationMs:Date.now()-e.sessionStartAt,attempts:e.sessionAttempts,correct:e.sessionCorrect},sessionStartAt:void 0}:e),setLanguage:t=>e(e=>({profile:{...e.profile,language:t}})),setTheme:t=>e(e=>({profile:{...e.profile,theme:t}})),nextChallenge:()=>{let n;let o=t(),a=r(o.profile.maxFactor,2,10);if(o.recentMistakes.length){let[e,t]=o.recentMistakes.shift().split(":"),[a,s]=t.includes("x")?t.split("x").map(Number):t.split("/").map(Number);n={op:"m"===e?"mul":"div",a,b:s}}else{let e=Object.values(o.mastery).find(e=>e.dueAt<=i());if(e){let[t,o]=e.key.split(":"),[a,s]=o.includes("x")?o.split("x").map(Number):o.split("/").map(Number);n={op:"m"===t?"mul":"div",a,b:s}}}let l=function(e,t,n){let o=n?{op:n.op,a:n.a,b:n.b,answer:"mul"===n.op?n.a*n.b:Math.floor(n.a/n.b)}:.5>Math.random()?m(e):d(e),a=!n&&t&&.5>Math.random()?"mul"===t?d(e):m(e):o;return{id:"".concat(a.op,":").concat(a.a,":").concat(a.b,":").concat(Date.now()),op:a.op,a:a.a,b:a.b,answer:a.answer,choices:function(e){let t=new Set([e]);for(;t.size<4;){let n=s(9)-4,o=Math.max(0,e+n+(0===n?s(3)+1:0));t.add(o)}return function(e){let t=e.slice();for(let e=t.length-1;e>0;e--){let n=Math.floor(Math.random()*(e+1));[t[e],t[n]]=[t[n],t[e]]}return t}([...t])}(a.answer),game:"mul"===a.op?.5>Math.random()?"multiply-groups":"array-builder":"division-dealer",input:.75>Math.random()?"mc":"wheel"}}(a,o.lastOp,n);e({current:l,startedAt:Date.now(),lastOp:l.op})},answer:n=>{var o,a,s;let c=t(),m=c.current;if(!m)return;let d=n===m.answer;Date.now(),null!==(o=c.startedAt)&&void 0!==o||Date.now();let f=l(m.op,m.a,m.b),p=c.mastery[f],h=function(e,t){let n=i();if(!e)return{key:"",score:t?1:0,ease:t?2:1.6,intervalSec:10,dueAt:n+10,lastResult:t};let o=r(e.score+(t?1:-2),0,5),a=r(e.ease+(t?.08:-.2),1.2,2.6),s=t?Math.max(10,Math.round(e.intervalSec*a)):10;return{...e,score:o,ease:a,intervalSec:s,dueAt:n+s,lastResult:t}}(p&&{...p,key:f},d);h.key=f;let b=Math.min(10,Math.max(0,2*c.profile.streak)),x={...c.profile};if(x.totalAttempts+=1,d)for(let e of(x.totalCorrect+=1,x.streak+=1,x.bestStreak=Math.max(x.bestStreak,x.streak),x.points+=10+b,x.streak%4==0&&(x.maxFactor=r(x.maxFactor+1,2,10),x.level=Math.max(x.level,x.maxFactor)),u))x.points>=e.cost&&(x.unlocked[e.id]=!0);else{x.streak=0,x.maxFactor=r(x.maxFactor-1,2,10),x.level=Math.max(1,x.maxFactor);let t="mul"===m.op?"m:".concat(m.a,"x").concat(m.b):"d:".concat(m.a,"/").concat(m.b),n=c.recentMistakes.slice();n.includes(t)||n.push(t),e({recentMistakes:n})}e({profile:x,mastery:{...c.mastery,[h.key]:h},sessionAttempts:(null!==(a=c.sessionAttempts)&&void 0!==a?a:0)+1,sessionCorrect:(null!==(s=c.sessionCorrect)&&void 0!==s?s:0)+(d?1:0)}),t().nextChallenge()},toggleSound:()=>e(e=>({profile:{...e.profile,soundOn:!e.profile.soundOn}}))}),{name:"mg2_state"}))},9376:function(e,t,n){"use strict";var o=n(5475);n.o(o,"usePathname")&&n.d(t,{usePathname:function(){return o.usePathname}}),n.o(o,"useRouter")&&n.d(t,{useRouter:function(){return o.useRouter}})},7960:function(){}},function(e){e.O(0,[587,883,648,971,117,744],function(){return e(e.s=4870)}),_N_E=e.O()}]);